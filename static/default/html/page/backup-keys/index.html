{% extends "layouts/auth.html" %}
{% block title %}{{_("Mailpile: Key Backup")}}{% endblock %}
{% block content %}

  <!-- Advanced - Backups -->
  <div class="add-top add-bottom">

    <h1>{{_("PRINT THIS PAGE")}}</h1>
    <h4>{{_("(Keep It In a Safe Place)")}}</h4>

    <div class="half-top add-bottom">
      <h4 class="text-center">{{_("Your Mailpile Passphrase")}}</h4>
      <p>{{_("For security reasons we ask that you manually write down your passphrase in the following field after you have printed out this piece of paper. Hide this piece of paper somewhere secure, e.g., your house, safe, bomb shelter, vault, etc...")}}</p>
    </div>

    <div class="add-bottom">
      <h4 class="text-center">{{_("Your Mailpile Master Key")}}</h4>
      <p>{{_("In the most tragic event of losing the hardware or data that your Mailpile runs on, you will need this master key (and the passphrase) to restore Mailpile from your backups. You do have back ups, right? Hint, hint, wink ;)")}}</p>
      <div class="setup-backup-printer-value center">
        <h4>{{ nice_fingerprint(config.master_key) }}</h4>
      </div>
    </div>
  
    <div class="text-center add-bottom add-top">
      <button id="btn-setup-backups-keys-print" class="button-alert">
        {{_("Print Page")}}
      </button> &nbsp;
      <button id="btn-setup-backups-keys-done" class="center">
        {{_("Done Printing")}}
      </button>
    </div>

  </div>

  <script>
  $(document).on('click', '#btn-setup-backups-keys-print', function(e) {
    e.preventDefault();
    window.print();
  });

  $(document).on('click', '#btn-setup-backups-keys-done', function(e) {
    e.preventDefault();
    Mailpile.API.settings_set_post({ 'web.nag_backup_key': -1 }, function() {
      window.location.href = '/in/inbox/'; 
    });
  });
  </script>

{% endblock %}
